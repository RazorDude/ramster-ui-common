!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common/http"),require("co"),require("@angular/common")):"function"==typeof define&&define.amd?define("ramster-ui-core",["exports","rxjs","rxjs/operators","@angular/core","@angular/common/http","co","@angular/common"],t):t(e["ramster-ui-core"]={},e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common.http,e.co,e.ng.common)}(this,function(e,o,r,t,b,s,n){"use strict";s=s&&s.hasOwnProperty("default")?s["default"]:s;var i=function(){function e(e,t){this.globalEventsService=e,this.router=t,this.initialDataLoaded=!1,this.loaderActive=!1,this.queryParams={},this.routeParams={}}return e.prototype.ngOnInit=function(){var n=this;this.globalEventsService.pageLoaded$.subscribe(function(e){return n.pageLoaded(e)}),this.globalEventsService.triggerInitialDataLoad$.subscribe(function(){return n.loadInitialData()}),this.globalEventsService.setLayoutData$.subscribe(function(e){return n.setLayoutData(e)}),this.globalEventsService.redirect$.subscribe(function(e){var t=e.route,r=e.options;return n.redirect(t,r)}),this.globalEventsService.toggleLoader$.subscribe(function(e){return n.toggleLoader(e)})},e.prototype.sendInitialDataLoadedEvent=function(){this.globalEventsService.initialDataLoaded({queryParams:this.queryParams,routeParams:this.routeParams})},e.prototype.pageLoaded=function(e){if(e)for(var t in e)this[t]=e[t];this.initialDataLoaded?this.sendInitialDataLoadedEvent():this.loadInitialData()},e.prototype.loadInitialData=function(){this.sendInitialDataLoadedEvent()},e.prototype.setLayoutData=function(e){for(var t in e)this[t]=e[t]},e.prototype.redirect=function(e,t){var r=t||{},n=r.queryParams;r.reloadInitialData&&(this.initialDataLoaded=!1),this.router.navigate([e],{queryParams:n||{}})},e.prototype.toggleLoader=function(e){this.loaderActive=e},e}(),a=function(){function e(e,t,r,n){this.activatedRoute=e,this.globalEventsService=t,this.onInitMethodNames=r,this.onInitialDataLoadedMethodNames=n,this.destroyed=new o.Subject}return e.prototype.ngOnInit=function(){var t=this;this.globalEventsService.initialDataLoaded$.pipe(r.takeUntil(this.destroyed)).subscribe(function(e){return t.initialDataLoaded(e)}),this.onInitMethodNames.forEach(function(e){"function"==typeof t[e]&&t[e]()})},e.prototype.reset=function(){this.queryParams=this.activatedRoute.snapshot.queryParams,this.routeParams=this.activatedRoute.snapshot.params},e.prototype.sendPageLoadedEvent=function(){this.globalEventsService.pageLoaded({queryParams:this.queryParams,routeParams:this.routeParams})},e.prototype.initialDataLoaded=function(t){var r=this;this.loggedInUser=t.user,this.queryParams=t.queryParams,this.routeParams=t.routeParams,this.onInitialDataLoadedMethodNames.forEach(function(e){"function"==typeof r[e]&&r[e](t)})},e.prototype.destructor=function(){this.destroyed.next(),this.destroyed.complete()},e.prototype.ngOnDestroy=function(){this.destructor()},e}();function u(n,o){var i,a,s,e,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function r(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,a&&(s=2&e[0]?a["return"]:e[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,e[1])).done)return s;switch(a=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,a=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=o.call(n,u)}catch(t){e=[6,t],a=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var c=function(){function e(){this.pageLoadedSource=new o.Subject,this.triggerInitialDataLoadSource=new o.Subject,this.initialDataLoadedSource=new o.Subject,this.setLayoutDataSource=new o.Subject,this.redirectSource=new o.Subject,this.notifySource=new o.Subject,this.toggleLoaderSource=new o.Subject,this.pageLoaded$=this.pageLoadedSource.asObservable(),this.triggerInitialDataLoad$=this.triggerInitialDataLoadSource.asObservable(),this.initialDataLoaded$=this.initialDataLoadedSource.asObservable(),this.setLayoutData$=this.setLayoutDataSource.asObservable(),this.redirect$=this.redirectSource.asObservable(),this.notify$=this.notifySource.asObservable(),this.toggleLoader$=this.toggleLoaderSource.asObservable()}return e.prototype.pageLoaded=function(e){this.pageLoadedSource.next(e)},e.prototype.triggerInitialDataLoad=function(){this.triggerInitialDataLoadSource.next()},e.prototype.initialDataLoaded=function(e){this.initialDataLoadedSource.next(e)},e.prototype.setLayoutData=function(e){this.setLayoutDataSource.next(e)},e.prototype.redirect=function(e,t){this.redirectSource.next({route:e,options:t})},e.prototype.notify=function(e,t){this.notifySource.next({type:e,message:t})},e.prototype.toggleLoader=function(e){this.toggleLoaderSource.next(e)},e.decorators=[{type:t.Injectable}],e}(),l=function(){function e(e){this.client=e}return e.prototype.run=function(d,h,p){var y=this;return new Promise(function(t,r){try{var n={},e={},o=null;if(p&&"object"==typeof p){var i=p.resolveWithFullResponse;e=function l(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}(p,["resolveWithFullResponse"]),n={resolveWithFullResponse:i}}if("get"===d.toLowerCase()){e&&"object"==typeof e||(e={});var a=e.params||{},s=new b.HttpParams,u=function(r){var e=a[r];if("object"==typeof e&&null!==e){if(e instanceof Array)return e.forEach(function(e){if("object"!=typeof e||null===e)s=s.set(r+"[]",e);else for(var t in e)s=s.set(r+"["+t+"]",e[t])}),"continue";for(var t in e)s=s.set(r+"["+t+"]",e[t]);return"continue"}s=s.set(r,e)};for(var c in a)u(c);s=s.set("_",(new Date).getTime().toString()),e.params=s}else e&&"object"==typeof e||(e={}),(o=e.body&&"object"==typeof e.body?e.body:{})._=(new Date).getTime(),delete e.body;e.responseType,y.client.request(new b.HttpRequest(d,h,o,e)).toPromise().then(function(e){return n.resolveWithFullResponse?t(e):t(e.body)},function(e){return r(e)})}catch(f){r(f)}})},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:b.HttpClient}]},e}(),f=function(){function e(e,t){this.globalEventsService=e,this.requestService=t,this.headers=new b.HttpHeaders({"Content-Type":"application/json"}),this.baseUrl="/"}return e.prototype.emptyToNull=function(e){var r=this;if(""===e)return null;if(e instanceof Date)return e;if(e instanceof Array)return e.map(function(e,t){return r.emptyToNull(e)});if("object"!=typeof e||null===e)return e;var t={};for(var n in e)t[n]=this.emptyToNull(e[n]);return t},e.prototype.handleError=function(e){this.globalEventsService.notify("error",e&&e.error&&e.error.error||"An error has occurred.")},e.prototype.create=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("post",""+o.baseUrl,{headers:o.headers,body:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype.read=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("get",o.baseUrl+"/item",{headers:o.headers,params:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype.readList=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("get",""+o.baseUrl,{headers:o.headers,params:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype.readSelectList=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("get",o.baseUrl+"/selectList",{headers:o.headers,params:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype.update=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("patch",o.baseUrl+"/item/"+n.id,{headers:o.headers,body:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype.bulkUpsert=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("put",""+o.baseUrl,{headers:o.headers,body:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.prototype["delete"]=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("delete",o.baseUrl+"/"+n.id,{headers:o.headers,body:o.emptyToNull(n)})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:c},{type:l}]},e}(),d=function(){function e(e,t){this.globalEventsService=e,this.requestService=t,this.headers=new b.HttpHeaders,this.baseUrl="/files"}return e.prototype.handleError=function(e){this.globalEventsService.notify("error",e&&e.error&&e.error.error||"An error has occurred.")},e.prototype.upload=function(n,o,i){var a=this;return new Promise(function(t,r){s(function(){var t,r;return u(this,function(e){switch(e.label){case 0:for(r in(t=new FormData).append("file",n,n.name),o)t.append(r,o[r]);return a.headers.set("Content-Type","multipart/form-data"),[4,a.requestService.run("post",""+a.baseUrl,{headers:a.headers,body:t})];case 1:return e.sent(),[2,{success:!0}]}})}).then(function(e){return t(e)},function(e){i&&i.handleError&&a.handleError(e),r({error:e||!0})})})},e.prototype.read=function(n){var o=this;return new Promise(function(t,r){s(function(){return u(this,function(e){switch(e.label){case 0:return[4,o.requestService.run("get",o.baseUrl+"/item",{headers:o.headers,params:n})];case 1:return[2,e.sent()]}})}).then(function(e){return t(e)},function(e){o.handleError(e),r({error:!0})})})},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:c},{type:l}]},e}(),h=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule]}]}],e}();e.RamsterUICoreModule=h,e.BaseLayoutComponent=i,e.BasePageComponent=a,e.BaseRESTService=f,e.FilesRESTService=d,e.getNested=function(e,t){if("object"!=typeof e||"string"!=typeof t)return null;var r=t.split("."),n=e;for(var o in r){var i=r[o];if(null===n)return n;if(void 0===n||"undefined"==typeof n[i])return n;n=n[i]}return n},e.setNested=function(e,t,r){var n=t.split(".");if(!n.length)return!1;for(var o=e,i=n.length-1,a=0;a<i;a++){var s=n[a];if("undefined"==typeof o[s])return!1;o=o[s]}return o[n[i]]=r,!0},e.GlobalEventsService=c,e.RequestService=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ramster-ui-core.umd.min.js.map